<!DOCTYPE html>
<html>
  <head>
    <title>Musubi</title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <%= display_meta_tags(default_meta_tags) %>
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>
    <link rel="stylesheet" href="https://rsms.me/inter/inter.css">
    <%= stylesheet_link_tag "tailwind", "data-turbo-track": "reload" %>


    <%= javascript_importmap_tags %>
    <%= favicon_link_tag 'favicon.png' %>
  </head>

  <body class="bg-stone-50">
    <header class="bg-white shadow">
      <div class="container mx-auto px-5 py-4 flex justify-between items-center">
        <%= link_to root_path, class: "font-bold text-xl" do %>
          Musubi
        <% end %>

        <div>
           <% if user_signed_in? && !current_user.guest? %>
             <%= link_to "イベント一覧", events_path, class: "mr-4 text-indigo-600 hover:text-indigo-800 font-medium" %>
             <span class="mr-4 text-gray-600">こんにちは、<%= current_user.name || current_user.email %>さん</span>
             <%= link_to "ログアウト", destroy_user_session_path, data: { turbo_method: :delete }, class: "text-gray-500 hover:text-gray-800" %>
           <% else %>
<div class="flex items-center gap-2">
               <%= button_to "Googleでログイン", user_google_oauth2_omniauth_authorize_path, data: { turbo: false }, class: "bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 font-medium" %>
               <%= button_to "Xでログイン", user_twitter2_omniauth_authorize_path, data: { turbo: false }, class: "bg-black text-white px-4 py-2 rounded hover:bg-gray-800 font-medium" %>
             </div>
             <% if user_signed_in? && current_user.guest? %>
               <div class="mt-2 text-sm text-right text-gray-400">
                 ゲストとして閲覧中 | <%= link_to "ログアウト", destroy_user_session_path, data: { turbo_method: :delete }, class: "underline hover:text-gray-600" %>
               </div>
             <% end %>
           <% end %>
        </div>
      </div>
    </header>
    <main class="<%= current_page?(root_path) ? '' : 'container mx-auto mt-28 px-5 flex' %>">
      <% flash.each do |key, value| %>
        <div class="fixed top-20 right-5 z-50 p-4 roundedshadow-lg <%= key == 'notice' ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800' %>">
          <%= value %>
        </div>
      <% end %>
      <%= yield %>
    </main>
    <%= turbo_frame_tag "modal" %>
  </body>
</html>
